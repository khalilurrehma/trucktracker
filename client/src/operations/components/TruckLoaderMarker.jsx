import React from "react";
import { alpha, useTheme } from "@mui/material/styles";

export default function TruckLoaderMarker({
  size = 34,
  fill = "#00e676", // KPI color
  heading = 0, // degrees
  label, // optional text (e.g., "85%")
}) {
  const theme = useTheme();
  const outline =
    theme.palette.mode === "dark" ? alpha("#000", 0.9) : alpha("#fff", 0.95);
  const stroke =
    theme.palette.mode === "dark" ? alpha("#fff", 0.95) : alpha("#000", 0.85);

  return (
    <div style={{ display: "grid", placeItems: "center", position: "relative" }}>
      {/* Label bubble */}
      {label != null && (
        <div
          style={{
            background: fill,
            color: "#fff",
            fontSize: 11,
            padding: "2px 8px",
            borderRadius: 6,
            marginBottom: 4,
            boxShadow:
              theme.palette.mode === "dark"
                ? "0 2px 6px rgba(0,0,0,0.7)"
                : "0 2px 6px rgba(0,0,0,0.25)",
            border: `1px solid ${alpha(stroke, 0.25)}`,
          }}
        >
          {label}
        </div>
      )}

      {/* Soft halo behind vehicle */}
      <div
        style={{
          width: size + 12,
          height: size + 12,
          borderRadius: "50%",
          background: alpha(outline, 0.35),
          position: "absolute",
          filter:
            theme.palette.mode === "dark"
              ? "blur(2px) brightness(1.1)"
              : "blur(2px)",
        }}
      />

      {/* Truck loader SVG */}
      <svg
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 512 512"
        width={size}
        height={size}
        style={{
          transform: `rotate(${heading}deg)`,
          transformOrigin: "center",
        }}
      >
        <g id="SVGRepo_iconCarrier">
          <g>
            <path
              style={{ fill: "#FEC24C" }}
              d="M216.496,135.473c-2.71-12.103-13.453-20.718-25.856-20.718H70.637c-14.636,0-26.5,11.864-26.5,26.5v141.224h140.57h64.671L216.496,135.473z"
            ></path>
            <g>
              <path
                style={{ fill: "#BC8D2F" }}
                d="M368.637,282.483H44.135v114.759h264.828h8.969h19.368c4.846,0,9.278-2.737,11.449-7.08l31.338-89.159C384.342,292.493,378.153,282.483,368.637,282.483"
              ></path>
              <path
                style={{ fill: "#BC8D2F" }}
                d="M173.677,229.517h-76.57c-4.882,0-8.828-3.955-8.828-8.828v-44.138c0-4.873,3.946-8.828,8.828-8.828h63.956c3.946,0,7.406,2.613,8.492,6.4l12.615,44.138C183.775,223.903,179.538,229.517,173.677,229.517"
              ></path>
              <path
                style={{ fill: "#BC8D2F" }}
                d="M414.897,79.448c0,19.5-15.81,35.31-35.31,35.31c-19.5,0-35.31-15.81-35.31-35.31s15.81-35.31,35.31-35.31C399.086,44.138,414.897,59.948,414.897,79.448"
              ></path>
            </g>
            <path
              style={{ fill: "#FEC24C" }}
              d="M379.586,114.759c-18.406,0-33.351-14.142-34.993-32.115L237.745,230.471l11.635,52.012h15.13l119.137-168.13C382.296,114.503,380.981,114.759,379.586,114.759"
            ></path>
            <g>
              <path
                style={{ fill: "#BC8D2F" }}
                d="M512,256l-32.38-3.602c-29.087-3.231-54.193-21.857-65.721-48.755l-7.83-18.264H512V256z"
              ></path>
              <path
                style={{ fill: "#BC8D2F" }}
                d="M467.862,300.138c-4.873,0-8.828-3.946-8.828-8.828s3.955-8.828,8.828-8.828c14.601,0,26.483-11.882,26.483-26.483c0-4.882,3.955-8.828,8.828-8.828c4.873,0,8.828,3.946,8.828,8.828C512,280.338,492.2,300.138,467.862,300.138"
              ></path>
            </g>
            <path
              style={{ fill: "#FEC24C" }}
              d="M413.417,69.876c0.865,3.063,1.483,6.232,1.483,9.569c0,12.456-6.488,23.349-16.216,29.634l42.699,76.297h52.966L413.417,69.876z"
            ></path>
            <path
              style={{ fill: "#E15649" }}
              d="M132.414,61.793c-14.566,0-26.483,11.917-26.483,26.483v26.483h52.966V88.276C158.897,73.71,146.979,61.793,132.414,61.793"
            ></path>
            <path
              style={{ fill: "#535353" }}
              d="M370.759,467.862H35.31c-19.421,0-35.31-15.89-35.31-35.31l0,0c0-19.421,15.89-35.31,35.31-35.31h335.448c19.421,0,35.31,15.89,35.31,35.31l0,0C406.069,451.972,390.179,467.862,370.759,467.862"
            ></path>
            <g>
              <path
                style={{ fill: "#A2A2A2" }}
                d="M123.586,432.552c0,4.873-3.955,8.828-8.828,8.828s-8.828-3.955-8.828-8.828s3.955-8.828,8.828-8.828S123.586,427.679,123.586,432.552"
              ></path>
              <path
                style={{ fill: "#A2A2A2" }}
                d="M167.724,432.552c0,4.873-3.955,8.828-8.828,8.828c-4.873,0-8.828-3.955-8.828-8.828s3.955-8.828,8.828-8.828C163.769,423.724,167.724,427.679,167.724,432.552"
              ></path>
              <path
                style={{ fill: "#A2A2A2" }}
                d="M211.862,432.552c0,4.873-3.955,8.828-8.828,8.828c-4.873,0-8.828-3.955-8.828-8.828s3.955-8.828,8.828-8.828C207.907,423.724,211.862,427.679,211.862,432.552"
              ></path>
              <path
                style={{ fill: "#A2A2A2" }}
                d="M256,432.552c0,4.873-3.955,8.828-8.828,8.828c-4.873,0-8.828-3.955-8.828-8.828s3.955-8.828,8.828-8.828C252.045,423.724,256,427.679,256,432.552"
              ></path>
              <path
                style={{ fill: "#A2A2A2" }}
                d="M300.138,432.552c0,4.873-3.955,8.828-8.828,8.828c-4.873,0-8.828-3.955-8.828-8.828s3.955-8.828,8.828-8.828C296.183,423.724,300.138,427.679,300.138,432.552"
              ></path>
              <path
                style={{ fill: "#A2A2A2" }}
                d="M70.621,432.552c0,19.5-15.81,35.31-35.31,35.31S0,452.052,0,432.552c0-19.5,15.81-35.31,35.31-35.31S70.621,413.052,70.621,432.552"
              ></path>
              <path
                style={{ fill: "#A2A2A2" }}
                d="M406.069,432.552c0,19.5-15.81,35.31-35.31,35.31c-19.5,0-35.31-15.81-35.31-35.31c0-19.5,15.81-35.31,35.31-35.31C390.259,397.241,406.069,413.052,406.069,432.552"
              ></path>
            </g>
            <g>
              <path
                style={{ fill: "#FEC24C" }}
                d="M194.207,308.966H44.138v17.655h150.069c4.873,0,8.828-3.946,8.828-8.828S199.08,308.966,194.207,308.966"
              ></path>
              <path
                style={{ fill: "#FEC24C" }}
                d="M247.172,344.276H44.138v17.655h203.034c4.873,0,8.828-3.946,8.828-8.828C256,348.222,252.045,344.276,247.172,344.276"
              ></path>
            </g>
          </g>
        </g>
      </svg>
    </div>
  );
}
